/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:83: UserWarning: Glyph 53364 (\N{HANGUL SYLLABLE KEUL}) missing from font(s) DejaVu Sans.
  plt.tight_layout()
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:83: UserWarning: Glyph 47000 (\N{HANGUL SYLLABLE RAE}) missing from font(s) DejaVu Sans.
  plt.tight_layout()
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:83: UserWarning: Glyph 49828 (\N{HANGUL SYLLABLE SEU}) missing from font(s) DejaVu Sans.
  plt.tight_layout()
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:83: UserWarning: Glyph 48324 (\N{HANGUL SYLLABLE BYEOL}) missing from font(s) DejaVu Sans.
  plt.tight_layout()
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:83: UserWarning: Glyph 48516 (\N{HANGUL SYLLABLE BUN}) missing from font(s) DejaVu Sans.
  plt.tight_layout()
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:83: UserWarning: Glyph 47448 (\N{HANGUL SYLLABLE RYU}) missing from font(s) DejaVu Sans.
  plt.tight_layout()
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:83: UserWarning: Glyph 49457 (\N{HANGUL SYLLABLE SEONG}) missing from font(s) DejaVu Sans.
  plt.tight_layout()
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:83: UserWarning: Glyph 45733 (\N{HANGUL SYLLABLE NEUNG}) missing from font(s) DejaVu Sans.
  plt.tight_layout()
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:85: UserWarning: Glyph 53364 (\N{HANGUL SYLLABLE KEUL}) missing from font(s) DejaVu Sans.
  plt.savefig(output_path, dpi=300, bbox_inches='tight')
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:85: UserWarning: Glyph 47000 (\N{HANGUL SYLLABLE RAE}) missing from font(s) DejaVu Sans.
  plt.savefig(output_path, dpi=300, bbox_inches='tight')
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:85: UserWarning: Glyph 49828 (\N{HANGUL SYLLABLE SEU}) missing from font(s) DejaVu Sans.
  plt.savefig(output_path, dpi=300, bbox_inches='tight')
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:85: UserWarning: Glyph 48324 (\N{HANGUL SYLLABLE BYEOL}) missing from font(s) DejaVu Sans.
  plt.savefig(output_path, dpi=300, bbox_inches='tight')
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:85: UserWarning: Glyph 48516 (\N{HANGUL SYLLABLE BUN}) missing from font(s) DejaVu Sans.
  plt.savefig(output_path, dpi=300, bbox_inches='tight')
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:85: UserWarning: Glyph 47448 (\N{HANGUL SYLLABLE RYU}) missing from font(s) DejaVu Sans.
  plt.savefig(output_path, dpi=300, bbox_inches='tight')
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:85: UserWarning: Glyph 49457 (\N{HANGUL SYLLABLE SEONG}) missing from font(s) DejaVu Sans.
  plt.savefig(output_path, dpi=300, bbox_inches='tight')
/Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/visualization.py:85: UserWarning: Glyph 45733 (\N{HANGUL SYLLABLE NEUNG}) missing from font(s) DejaVu Sans.
  plt.savefig(output_path, dpi=300, bbox_inches='tight')
======================================================================
데이터셋 생성 중...
======================================================================
경고: 일부 클래스의 파일이 2개 미만이어서 Random Split 사용합니다 (최소값: 1)
[단계 1] 원본 훈련 데이터 수집 중...

[증강 전 훈련 레이블 분포]
  클래스 0 (40Hz): 3657 샘플
  클래스 1 (50Hz): 61 샘플
  클래스 2 (60Hz): 1728 샘플

[클래스별 증강 배수 (모두 최대값으로 정렬)]
  클래스 0 (40Hz): 1.00배
  클래스 1 (50Hz): 59.95배
  클래스 2 (60Hz): 2.12배

[단계 2] SNR 기반 클래스별 균등 증강 중...
  클래스 0 (40Hz): 0개 파일 증강
  클래스 2 (60Hz): 4개 파일 증강

[단계 3] 테스트 데이터 수집 중...

[증강 후 최종 훈련 레이블 분포]
  클래스 0 (40Hz): 6594 샘플 (27.3%)
  클래스 1 (50Hz): 690 샘플 (2.9%)
  클래스 2 (60Hz): 16834 샘플 (69.8%)

[테스트 레이블 분포]
  클래스 0 (40Hz): 769 샘플 (49.4%)
  클래스 1 (50Hz): 40 샘플 (2.6%)
  클래스 2 (60Hz): 747 샘플 (48.0%)

✓ 훈련 데이터: (24118, 3), 테스트 데이터: (1556, 3)

======================================================================
k-Nearest Neighbors 모델 학습
======================================================================

모델 학습 중...

✓ 훈련 정확도: 1.0000
✓ 테스트 정확도: 0.9460

======================================================================
분류 보고서
======================================================================
              precision    recall  f1-score   support

        40Hz       0.99      0.97      0.98       769
        50Hz       0.22      0.10      0.14        40
        60Hz       0.92      0.97      0.95       747

    accuracy                           0.95      1556
   macro avg       0.71      0.68      0.69      1556
weighted avg       0.94      0.95      0.94      1556

======================================================================
SNR별 성능 분석
======================================================================
SNR 메타데이터 없음 (테스트 셋에 증강 데이터 미포함)

======================================================================
시각화 생성 중...
======================================================================
혼동 행렬 저장: /Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/preprocessed_data/confusion_matrix.png
클래스 성능 그래프 저장: /Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/preprocessed_data/class_performance.png
통합 성능 분석 그래프 저장: /Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/preprocessed_data/combined_performance.png

✓ 모델 저장: /Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/model_results/knn_model.pkl
✓ 스케일러 저장: /Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/model_results/scaler.pkl
✓ 결과 저장: /Users/seohyeon/AT_freq_tuning/freq_tuning_knn/knn_512/preprocessed_data/training_results.txt

